{% extends "base.html" %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-12 col-md-6 col-lg-4">
    <div class="card glass anim-soft">
      <div class="card-body">
        <h5 class="card-title mb-3">Login</h5>
        <div class="mb-3">
          <label class="form-label">Username</label>
          <input type="text" class="form-control" id="username" autocomplete="username">
        </div>
        <div class="mb-3">
          <label class="form-label">Password</label>
          <input type="password" class="form-control" id="password" autocomplete="current-password">
        </div>
        <div class="d-grid">
          <button class="btn btn-primary" id="login-btn">Sign in</button>
        </div>
        <div class="text-danger small mt-2" id="login-error" style="display:none;"></div>
      </div>
    </div>
  </div>
</div>
<script>
  document.getElementById('login-btn').addEventListener('click', async () => {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;
    const err = document.getElementById('login-error');
    err.style.display = 'none';
    try {
      const res = await fetch('/api/auth/login', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        credentials: 'include',
        body: JSON.stringify({username, password})
      });
      if (!res.ok) {
        err.textContent = 'Invalid credentials';
        err.style.display = 'block';
        return;
      }
      window.location.href = '/settings';
    } catch (e) {
      err.textContent = 'Login failed';
      err.style.display = 'block';
    }
  });
</script>
{% endblock %}
